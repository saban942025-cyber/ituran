<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>××œ×©×™× ×•×Ÿ ××™×ª×•×¨×Ÿ - ××™×ª×•×¨ ×›×©×œ×™×</title>
    <style>
        body { font-family: sans-serif; background: #f0f2f5; margin: 20px; text-align: center; }
        .debug-panel { background: #fff; padding: 20px; border-radius: 8px; border: 2px solid #e74c3c; margin-bottom: 20px; }
        .success-panel { border-color: #27ae60; }
        .log-box { background: #222; color: #0f0; padding: 10px; text-align: left; direction: ltr; font-family: monospace; border-radius: 5px; height: 150px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; background: white; }
        th, td { padding: 10px; border: 1px solid #ddd; }
    </style>
</head>
<body>
    <h1>ğŸ•µï¸ ××œ×©×™× ×•×Ÿ ××™×ª×•×¨×Ÿ - ××™×ª×•×¨ × ×§×•×“×•×ª ×›×©×œ</h1>
    
    <div id="status-box" class="debug-panel">
        <h2 id="status-title">×‘×“×™×§×ª ×ª×§×™× ×•×ª × ×ª×•× ×™×...</h2>
        <div id="debug-log" class="log-box"></div>
    </div>

    <table>
        <thead>
            <tr>
                <th>×¨×›×‘</th>
                <th>×¡×˜×˜×•×¡</th>
                <th>××™×“×¢ ×’×•×œ××™ (Debug)</th>
            </tr>
        </thead>
        <tbody id="data-table"></tbody>
    </table>

    <script>
        function addLog(msg) {
            const log = document.getElementById('debug-log');
            log.innerHTML += `> ${new Date().toLocaleTimeString()}: ${msg}<br>`;
        }

        async function inspectData() {
            addLog("××ª×—×™×œ ××©×™×›×ª × ×ª×•× ×™× ×-fleet_db.json...");
            try {
                const res = await fetch('fleet_db.json');
                if (!res.ok) throw new Error("×§×•×‘×¥ ×”-JSON ×œ× × ××¦× ×‘×©×¨×ª");
                
                const data = await res.json();
                const vehicles = Object.entries(data.vehicles || {});
                
                if (vehicles.length === 0) {
                    addLog("âš ï¸ ×›×©×œ: ×”×§×•×‘×¥ ×§×™×™× ××š ×¨×©×™××ª ×”×¨×›×‘×™× ×¨×™×§×”.");
                    document.getElementById('status-title').innerText = "âŒ ×”×›×©×œ: ×”×‘×•×˜ ×œ× ×–×™×”×” ×¨×›×‘×™× ×‘××¤×”";
                } else {
                    addLog(`âœ… ×”×¦×œ×—×”: × ××¦××• ${vehicles.length} ×¨×›×‘×™×.`);
                    document.getElementById('status-box').classList.add('success-panel');
                    document.getElementById('status-title').innerText = "âœ… × ×ª×•× ×™× ×–×•×¨××™× ×ª×§×™×Ÿ";
                }

                const tbody = document.getElementById('data-table');
                tbody.innerHTML = vehicles.map(([id, v]) => `
                    <tr>
                        <td>${id}</td>
                        <td>${v.current_status}</td>
                        <td><small>${v.debug_info || '××™×Ÿ ××™×“×¢'}</small></td>
                    </tr>
                `).join('');

            } catch (err) {
                addLog(`âŒ ×©×’×™××” ×§×¨×™×˜×™×ª: ${err.message}`);
                document.getElementById('status-title').innerText = "âŒ ×”×›×©×œ: ×‘×¢×™×™×ª ×’×™×©×” ×œ×§×•×‘×¥ ×”× ×ª×•× ×™×";
            }
        }
        inspectData();
    </script>
</body>
</html>
